{% extends "admin_dashboard.html" %}
{% block content %}
  <link rel="stylesheet" href="../static/assets/css/styles.min.css" />
    <link rel="stylesheet" href="../static/assets/css/n.css" />
<!-- Material Icons -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">


<!-- =========================
     CHART SECTION
========================= -->
<div class="dashboard">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <div class="chart-container">
        <canvas id="studentScoresChart"></canvas>
    </div>
</div>

<script>
const studentScores = {{ exam_scores | safe }};

const terms = [
    'T1 E1','T1 E2','T1 E3',
    'T2 E1','T2 E2','T2 E3',
    'T3 E1','T3 E2','T3 E3'
];

const datasets = Object.keys(studentScores).map(year => ({
    label: `Year ${year}`,
    data: studentScores[year] || Array(9).fill(null),
    borderColor: '#' + Math.floor(Math.random()*16777215).toString(16),
    tension: 0.3
}));

new Chart(document.getElementById('studentScoresChart'), {
    type: 'line',
    data: { labels: terms, datasets },
    options: {
        responsive: true,
        plugins: {
            legend: { position: 'top' },
            title: {
                display: true,
                text: '{{ student_id }} Performance'
            }
        }
    }
});
</script>

<!-- =========================
     RESULTS SECTION
========================= -->
<div class="container">

{% if student_marks %}
{% for marks in range(3) %}

<h5>
    {{ student_marks[marks][1] }} •
    Term {{ student_marks[marks][2] }} •
    {{ student_marks[marks][3] }}
</h5>

<!-- ===== DESKTOP TABLE ===== -->
<div class="desktop-only">
<table>
    <thead>
        <tr>
            <th>Subject</th>
            <th>Marks</th>
        </tr>
    </thead>
    <tbody>
        <tr><td>Mathematics</td><td>{{ student_marks[marks][4] }}</td></tr>
        <tr><td>Biology</td><td>{{ student_marks[marks][5] }}</td></tr>
        <tr><td>Chemistry</td><td>{{ student_marks[marks][6] }}</td></tr>
        <tr><td>Physics</td><td>{{ student_marks[marks][7] }}</td></tr>
        <tr><td>Geography</td><td>{{ student_marks[marks][8] }}</td></tr>
        <tr><td>Business</td><td>{{ student_marks[marks][9] }}</td></tr>
        <tr><td>English</td><td>{{ student_marks[marks][10] }}</td></tr>
        <tr><td>Kiswahili</td><td>{{ student_marks[marks][11] }}</td></tr>
        <tr><td>CRE</td><td>{{ student_marks[marks][12] }}</td></tr>
        <tr><td>French</td><td>{{ student_marks[marks][13] }}</td></tr>
        <tr><th>Average</th><th>{{ student_marks[marks][14] }}</th></tr>
    </tbody>
</table>
</div>

<!-- ===== MOBILE CARDS ===== -->
<div class="mobile-only">
<div class="marks-card">
    <div><strong>Mathematics</strong><span>{{ student_marks[marks][4] }}</span></div>
    <div><strong>Biology</strong><span>{{ student_marks[marks][5] }}</span></div>
    <div><strong>Chemistry</strong><span>{{ student_marks[marks][6] }}</span></div>
    <div><strong>Physics</strong><span>{{ student_marks[marks][7] }}</span></div>
    <div><strong>Geography</strong><span>{{ student_marks[marks][8] }}</span></div>
    <div><strong>Business</strong><span>{{ student_marks[marks][9] }}</span></div>
    <div><strong>English</strong><span>{{ student_marks[marks][10] }}</span></div>
    <div><strong>Kiswahili</strong><span>{{ student_marks[marks][11] }}</span></div>
    <div><strong>CRE</strong><span>{{ student_marks[marks][12] }}</span></div>
    <div><strong>French</strong><span>{{ student_marks[marks][13] }}</span></div>
    <hr>
    <div><strong>Average</strong><span>{{ student_marks[marks][14] }}</span></div>
</div>
</div>

{% endfor %}
{% else %}
<p>No examination records found.</p>
{% endif %}

</div>


<script src="../static/assets/libs/jquery/jquery.min.js"></script>
  <script src="../static/assets/libs/bootstrap.bundle.min.js"></script>
  <script src="../static/assets/js/sidebarmenu.js"></script>
  <script src="../static/assets/js/app.min.js"></script>
  <script src="../static/assets/libs/apexcharts/apexcharts.min.js"></script>
  <script src="../static/assets/libs/simplebar/simplebar.js"></script>
  <script src="../static/assets/js/dashboard.js"></script>
      <script src="/../static/vendor/chart.js/Chart.min.js"></script>
  <script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
  <script nomodule src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"></script>

{% endblock %}
